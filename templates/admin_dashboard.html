{% extends "base.html" %}
{% block content %}
<h2>Admin Dashboard</h2>

<div class="row mb-4">
    <div class="col-md-4"><div class="card p-3 bg-white"><h5>Doctors: {{ doctors|length }}</h5></div></div>
    <div class="col-md-4"><div class="card p-3 bg-white"><h5>Patients: {{ patients|length }}</h5></div></div>
    <div class="col-md-4"><div class="card p-3 bg-white"><h5>Appointments: {{ appointments|length }}</h5></div></div>
</div>

<div class="row">
    <div class="col-md-4">
        <div class="card">
            <div class="card-header">Add Doctor</div>
            <div class="card-body">
                <form method="POST">
                    <input type="hidden" name="add_doctor" value="1">
                    <div class="mb-2"><input type="text" name="name" class="form-control" placeholder="Name" required></div>
                    <div class="mb-2"><input type="text" name="username" class="form-control" placeholder="Login Username" required></div>
                    <div class="mb-2"><input type="password" name="password" class="form-control" placeholder="Login Password" required></div>
                    <div class="mb-2">
                        <select name="specialization" class="form-control">
                            {% for dept in departments %}
                            <option value="{{ dept.name }}">{{ dept.name }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <button class="btn btn-primary w-100">Add</button>
                </form>
            </div>
        </div>
    </div>

    <div class="col-md-8">
        <h4>Doctors List</h4>
        <table class="table table-bordered">
            <tr><th>Name</th><th>Spec</th><th>Action</th></tr>
            {% for doc in doctors %}
            <tr>
                <td>{{ doc.name }}</td>
                <td>{{ doc.specialization }}</td>
                <td><a href="/delete_doctor/{{ doc.id }}" class="btn btn-danger btn-sm">Delete</a></td>
            </tr>
            {% endfor %}
        </table>

        <h4>All Appointments</h4>
        <table class="table table-sm">
            <tr><th>Date</th><th>Dr.</th><th>Patient</th><th>Status</th></tr>
            {% for appt in appointments %}
            <tr>
                <td>{{ appt.date_time }}</td>
                <td>{{ appt.doctor.name }}</td>
                <td>{{ appt.patient.name }}</td>
                <td>{{ appt.status }}</td>
            </tr>
            {% endfor %}
        </table>
    </div>
</div>
{% endblock %}